<app-navbar></app-navbar>

<div class="w-full min-h-[calc(100vh-60px)] mt-[60px] pt-12 pb-6 px-[5%] relative">

  <h1>User</h1>

  <div *ngIf="confirmMessage || errorMessage" class="w-full lg:w-1/2 my-10">
    <mat-card>
      <mat-card-content [ngClass]="{'text-green-500': confirmMessage, 'text-red-500': errorMessage}">
        {{confirmMessage ? confirmMessage : errorMessage}}
      </mat-card-content>
    </mat-card>
  </div>

  <div *ngIf="user" class="my-10">

    <p> <span class="text-[#c2185b] break-words">ID:</span> {{user.id}} </p>
    <p> <span class="text-[#c2185b] break-words">Name:</span> {{user.name}} </p>
    <p> <span class="text-[#c2185b] break-words">Email:</span> {{user.email}} </p>
    <p> <span class="text-[#c2185b] break-words">Gender:</span> {{user.gender}} </p>
    <p> <span class="text-[#c2185b] break-words">Status:</span> {{user.status}} </p>

    <div *ngIf="posts.length > 0 && showComments" class="mt-10">
      <h2>Posts <span>({{posts.length}})</span></h2>

      <div class="my-5" *ngFor="let post of posts">
        <mat-card>
          <mat-card-content>
            <h3>{{post.title}}</h3>
            <p>{{post.body}}</p>
          </mat-card-content>
        </mat-card>

        <div *ngIf="comments.length > 0" class="p-4">
          <h4>Comments <span>({{comments.length}})</span></h4>
          <div *ngFor="let comment of comments">
            <p>{{comment.body}}
              (<small class="break-words"> <span class="text-[#c2185b]">{{ comment.email }}</span> </small>)
            </p>
          </div>
        </div>

        <div class="p-4">
          <button mat-raised-button (click)="toggleForm(post.id)">Add Comment</button>
          <div [ngClass]="{'hidden mt-4': !hideForm[post.id], 'block mt-4': hideForm[post.id]}">
            <form [formGroup]="commentForm" (ngSubmit)="addComment()">
              <mat-form-field class="min-w-[250px]">
                <mat-label>Name</mat-label>
                <input matInput value="" type="text" formControlName="name">
              </mat-form-field>

              <mat-form-field class="min-w-[250px]">
                <mat-label>Email</mat-label>
                <input matInput value="" type="email" formControlName="email">
              </mat-form-field>

              <div>
                <mat-form-field class="w-full min-w-[250px] max-w-[500px]">
                  <mat-label>Comment</mat-label>
                  <textarea matInput type="text" formControlName="body"></textarea>
                </mat-form-field>
              </div>
              <button type="submit" mat-raised-button color="primary" [disabled]="!commentForm.valid">
                <mat-icon>add</mat-icon>
              </button>
            </form>
          </div>
        </div>

        <mat-divider></mat-divider>
      </div>

    </div>

    <div *ngIf="!spinner && !posts.length && noPostsMessage" class="mt-10">
      <p>{{noPostsMessage}}</p>
    </div>

  </div>

  <div *ngIf="spinner" class="spinner-container w-full h-screen top-0 left-0 z-[1] flex justify-center items-center">
    <mat-spinner></mat-spinner>
  </div>

</div>
